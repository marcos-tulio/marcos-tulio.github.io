!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SimpleMaskMoney={})}(this,(function(e){"use strict";const t={allowNegative:!1,negativeSignAfter:!1,decimalSeparator:",",fixed:!0,fractionDigits:2,prefix:"",suffix:"",thousandsSeparator:".",cursor:"end",allowEmpty:!1};function n(e){return Object.assign(Object.assign({},t),e)}const r="0123456789".split("");function i(e,t){const i=n(t),{beforeFormat:o,afterFormat:l,allowNegative:s,negativeSignAfter:u,fractionDigits:a,decimalSeparator:c,thousandsSeparator:f,fixed:d,prefix:g,suffix:m,cursor:p,allowEmpty:h}=i;if("undefined"==typeof document)return()=>{};const v="string"==typeof e?document.querySelector(e):null!=e?e:null;if(null===v)return()=>{};if(!(v instanceof HTMLInputElement))throw new Error("the element must be an input");const y=d?"0":"_";v.hasAttribute("inputmode")||v.setAttribute("inputmode","numeric");const b=(e,t)=>{v.value=e,v.dispatchEvent(new InputEvent("input")),x(t),A=e,null==l||l(e)},k=g.length,S=[...r,"Backspace",s?"-":""],N=3+c.length+a,w=e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:v.value.length-m.length},E=e=>e<k,$=e=>m.length>0&&e>w(),M=(e,t=!1,n)=>{let r;const i=[...e];let o=new Array;if(n){[r]=n;const[,e]=n,[t,o]=e,l=i.splice(...e);if("remove"===r&&1===l.length){const[e]=l;e!==c&&e!==f||i.splice(t-1,o)}}let l=N,s=!1,d=0,p=!1;for(let e;e=i.pop();)if("-"!==e)if(e===c&&s&&t){const e=o.indexOf(c);o.splice(e,c.length);const t=o.slice(0,a);t.length<o.length&&(l+=o.length-t.length),o=[c,...t],s=!0}else Number.isNaN(Number(e))||" "===e||(l-=1,e===y?d+=1:e!==c&&d>0&&(d=0),0===l&&(o.unshift(f),l=3),o.unshift(e),o.length!==a||s||(o.unshift(c),s=!0));else p=!0;return 0!==d&&o.splice(0,d),o.every((e=>e===y))&&"remove"===r&&(p=!1),o.length<=a?o=[y,c,o.join("").padStart(a,y)]:o.length===a+c.length&&o.unshift(y),p&&o[u?"push":"unshift"]("-"),(e=>`${g}${e}${m}`)(o.join(""))},x=e=>{const t=w();let n=[t,t];return"move"===p&&e&&(n="number"==typeof e[1]?[e[0],e[1]]:[e[0],e[0]]),v.setSelectionRange(...n),n};null==o||o(v.value);const j=M(v.value.split(""),!0);let A=j;const O=e=>{var t,n;null==o||o(v.value);const r=w();let i=null!==(t=v.selectionStart)&&void 0!==t?t:r,l=null!==(n=v.selectionEnd)&&void 0!==n?n:r;if("Enter"===e.key)return;if("Tab"===e.key)return;if(e.ctrlKey&&"a"===e.key)return x([k,r]);if(e.ctrlKey&&"z"===e.key)return b(j);if("move"===p&&("ArrowLeft"===e.key&&i>k||"ArrowRight"===e.key&&i<r))return;if(e.preventDefault(),e.ctrlKey&&"a"===e.key)return x([k,r]);if(!S.includes(e.key))return;const s="Backspace"===e.key;if(E(i)&&([i,l]=x([k])),$(i)&&([i,l]=x([r])),s&&0===i)return;if(h&&s&&v.value.length<=g.length+1)return void b(g);const u=v.value.split(""),a=Math.abs(l-i),c=a>0,f=c?[i,a]:[i-1,1],d=[i,c?a:0,e.key],m=s?"remove":"add",y=M(u,!1,[m,{add:d,remove:f}[m]]);if(!s&&A.length<y.length&&i<w(y))i+=y.length-A.length,l+=y.length-A.length;else if(s&&A.length>y.length&&i>k){const e=A.length-y.length;i=i-e<=k?k:i-e,l=l-e<=k?k:l-e}b(y,[i,l])},T=()=>{if(document.activeElement!==v)return;const e=v.selectionStart,t=v.selectionEnd;if("number"!=typeof e||"number"!=typeof t)return;let n;const r=E(e),i=$(t),o=$(e),l=E(t);(r||i||l||o)&&(n=[r?k:i?w():e,l?k:i?w():t]),n&&x(n)};if(b(h&&j===`${g}0`?"":j),v.hasAttribute("readonly")||v.hasAttribute("disabled"))return()=>{};v.addEventListener("keydown",O),document.addEventListener("selectionchange",T);const L=()=>{v.removeEventListener("keydown",O),document.removeEventListener("selectionchange",T),delete v.removeMask};return Object.defineProperty(v,"removeMask",{value:L,configurable:!0,enumerable:!0,writable:!0}),L}function o(e){if("undefined"==typeof document)return()=>{};const t="string"==typeof e?document.querySelector(e):null!=e?e:null;if(null===t)return()=>{};if(!(t instanceof HTMLInputElement))throw new Error("the element must be an input");return()=>{if("removeMask"in t&&"function"==typeof t.removeMask)return t.removeMask()}}function l(e,t){const{decimalSeparator:r,allowNegative:i}=n(t),o=e=>e.toString().replace(".",r),l=("number"==typeof e?o(e):(e=>{const t=Number(e);return Number.isNaN(t)?e:o(t)})(e)).split("");let s="";const u=i&&l.includes("-");for(let e;e=l.shift();)Number.isNaN(Number(e))||(s+=e),e===r&&(s+=".");return parseFloat(`${u?"-":""}${s}`)}function s(e,t){return(n,r={})=>e(n,Object.assign(Object.assign({},t),r))}function u(e,t){const{fixed:r,prefix:i,suffix:o,fractionDigits:s,thousandsSeparator:u,decimalSeparator:a,allowNegative:c,negativeSignAfter:f}=n(t),d=r?"0":"_",g=e=>`${i}${e}${o}`,m=e=>e.padEnd(s,d),p=e.toString();if(0===p.length)return g(`${d}${a}${m("")}`);let h="";const v=c&&p.includes("-"),y=l(e,t).toString().replace("-",""),[b,k]=y.toString().split("."),S=m(k?k.substring(0,s):""),N=[];for(let e=0;e<b.length;e+=3)N.unshift(b.substring(b.length-e,b.length-e-3));return h=`${N.join(u)}${a}${S}`,v&&(h=f?`${h}-`:`-${h}`),g(h)}const a={setMask:i,removeMask:o,formatToNumber:l,createInstanceOf:s,formatToCurrency:u};e.createInstanceOf=s,e.default=a,e.formatToCurrency=u,e.formatToNumber=l,e.removeMask=o,e.setMask=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=simple-mask-money.umd.js.map
